From abdbacbef6fdfed6d9c2fa5a10390134e81b05ef Mon Sep 17 00:00:00 2001
From: Aditya Garg <85610623+AdityaGarg8@users.noreply.github.com>
Date: Thu, 20 Oct 2022 08:09:21 +0530
Subject: [PATCH] Update vars.c

---
 drivers/firmware/efi/vars.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/firmware/efi/vars.c b/drivers/firmware/efi/vars.c
index dd74d2ad318408..35edba93cf1408 100644
--- a/drivers/firmware/efi/vars.c
+++ b/drivers/firmware/efi/vars.c
@@ -209,7 +209,7 @@ efivar_set_variable_blocking(efi_char16_t *name, efi_guid_t *vendor,
 	if (data_size > 0) {
 		status = check_var_size(attr, data_size +
 					      ucs2_strsize(name, 1024));
-		if (status != EFI_SUCCESS)
+		if (status != EFI_SUCCESS && status != EFI_UNSUPPORTED)
 			return status;
 	}
 	return __efivars->ops->set_variable(name, vendor, attr, data_size, data);
@@ -242,7 +242,7 @@ efi_status_t efivar_set_variable_locked(efi_char16_t *name, efi_guid_t *vendor,
 	if (data_size > 0) {
 		status = check_var_size_nonblocking(attr, data_size +
 							  ucs2_strsize(name, 1024));
-		if (status != EFI_SUCCESS)
+		if (status != EFI_SUCCESS && status != EFI_UNSUPPORTED)
 			return status;
 	}
 	return setvar(name, vendor, attr, data_size, data);
